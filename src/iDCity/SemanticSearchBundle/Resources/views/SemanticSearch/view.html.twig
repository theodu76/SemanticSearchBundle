{% extends "iDCitySemanticSearchBundle::layout.html.twig" %}

{%block title %}
	Barre de recherche - {{ parent() }}
{% endblock %}


{% block idCitySemanticSearch_body %}



<div class=researchBar>
	<h3>Barre de recherche</h3>
	<form action accept-charset="UTF-8">  
	<input type = "search" name = "terme" id = "by_name" placeholder="Rechercher sur le site…">
	<input type = "button" name = "s" id= "s" value = "Rechercher">
	</form> 
</div>

<div class=resultContainer>
	<h3>Résultats obtenus</h3>
	<hr>	
	<ul class="ideas-list">
		<li id="proposal-12" class="idea block" data-id=12 >
			<div class="idea-content proposal 12">
				<p1 id="article1" >
				</p1>
			</div>
		</li>
	</ul>
		
	</p1>
</div>



	


<script>
  $(document).ready(function(){
	
	
  	$('#s').click(function() {
		
	    var data = $('#by_name')[0].value;
	    console.log($('#by_name'));
	    console.log(data);
	    var json = { words: data.split(' ').join('|')}
	    //var json = JSON.stringify(eval('('+ str+ ')'));

		

	    $.ajax({
	        type: 'POST',
	        url: 'http://localhost:3000',
	        data: json,
	      }).done(function(msg){
	        refreshPage();  
	    });

		

	    function refreshPage(){
	    //Mettre à jour les données de la page

	    	var list = "";
	    	//pour chaque élément trouvé dans le JSON, on peuple une liste
	    	$.each(JSON.parse(['data']), function(i, item){
	    		var li = document.createElement('li');
	    		var text = document.createNodeText( item.words);
	    		li.appendChild(text);
	    		list.appendChild(li);
				console.log(list);
				$('#article1').text(list);
	    	})
	    }

    });

  });
</script>




{% endblock %}